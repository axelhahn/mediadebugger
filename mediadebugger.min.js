/* https://www.axel-hahn.de/ */
var mdbg=function(){this._oDivEvents=false;this._oDivLog=false;this._aLogs=false;this._aMedia=[];this._aMediaLastvar=[];this.starttime=false;this.name=false;this._aVartypes={0:"bool",1:"integer",2:"float",3:"char",4:"string",5:"array",6:"object",99:"unknown"};this._aConst={properties:{audioTracks:{type:6},autoplay:{type:0},buffered:{type:6,readonly:true},controller:{type:6},controls:{type:6},crossOrigin:{type:6},currentSrc:{type:4},currentTime:{type:2},defaultMuted:{type:2},networkState:{type:3,values:["0 = NETWORK_EMPTY - audio/video has not yet been initialized","1 = NETWORK_IDLE - audio/video is active and has selected a resource, but is not using the network","2 = NETWORK_LOADING - browser is downloading data","3 = NETWORK_NO_SOURCE - no audio/video source found"]},readyState:{values:["0 = HAVE_NOTHING - no information whether or not the audio/video is ready","1 = HAVE_METADATA - metadata for the audio/video is ready","2 = HAVE_CURRENT_DATA - data for the current playback position is available, but not enough data to play next frame/millisecond","3 = HAVE_FUTURE_DATA - data for the current and at least the next frame is available","4 = HAVE_ENOUGH_DATA - enough data available to start playing"]}},eventnames:["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"]};this._addSpansForEachEvent=function(){if(!this._oDivEvents){return false}var b="";for(var a=0;a<this._aConst.eventnames.length;a++){eventname=this._aConst.eventnames[a];b+='<span id="span-'+eventname+'" class="event">'+eventname+"</span> "}this._oDivEvents.innerHTML=b+'<div style="clear: both;"></div>'};this._attachEachEvent=function(d){if(!this._aMedia.length||d>this._aMedia.length){console.log("ERROR in _attachEachEvent: media id "+d+" is wrong: no media or id larger than count.");return false}var a=this;for(var b=0;b<this._aConst.eventnames.length;b++){var c=this._aConst.eventnames[b];this._aMedia[d].addEventListener(c,function(e){a.fireListener(e,d)})}this.log("info","debugger","events were added to media"+d)};this._microtime=function(b){var a=new Date().getTime()/1000;var c=parseInt(a);return(b)?a:(Math.round((a-c)*1000)/1000)+" "+c};this._getName=function(){for(var a in this.global){if(this.global[a]===this){return this._setName(a)}}};this._setName=function(a){this.name=a;return this.name};this._rotateCLass=function(g,a){for(var c=a;c>-1;c--){var f=g+"-"+c;var d=(c===(a)?"":g+"-"+(c+1));var e=document.getElementsByClassName(f);for(var b=0;b<e.length;b++){e[b].className=e[b].className.replace(f,d)}}};this._markEvent=function(a){this._rotateCLass("mark",10);oSpan=document.getElementById("span-"+a);oSpan.className="event mark-0"};this.attach=function(a){if(!a||!a.tagName||(!a.tagName==="AUDIO"&&!a.tagName==="VIDEO")){console.log("ERROR in attach: wrong media object tag: "+a.tagName);console.log(a);return false}this._aMedia.push(a);this.log("info","debugger",a.tagName+" object was added as media"+(this._aMedia.length-1));this._aMediaLastvar.push({networkState:0,readyState:0});this._attachEachEvent(this._aMedia.length-1)};this.setOutputEvents=function(a){if(!a||!a.tagName||!a.tagName==="DIV"){console.log("ERROR in setOutputEvents: no div tag");console.log(a);return false}this._oDivEvents=a;this._addSpansForEachEvent();return true};this.setOutputLogs=function(a){if(!a||!a.tagName||!a.tagName==="DIV"){console.log("ERROR in setOutputLogs: no div tag");console.log(a);return false}this._oDivLog=a;this.showlog();return true};this.fireListener=function(a,f){this._markEvent(a.type);this.log("event "+a.type,"media"+f,"event "+a.type);var d=this._aMediaLastvar[f]["readyState"];var c=this._aMedia[f]["readyState"];var e=this._aMediaLastvar[f]["networkState"];var b=this._aMedia[f]["networkState"];if(d!==c){this.log("state readyState","media"+f,"readyState switched from "+d+" to "+this._aConst.properties.readyState.values[c]);this._aMediaLastvar[f]["readyState"]=c}if(e!==b){this.log("state networkState","media"+f,"networkState switched from "+e+" to "+this._aConst.properties.networkState.values[b]);this._aMediaLastvar[f]["networkState"]=b}};this.log=function(d,a,b){var c=this._microtime(true)-this.starttime;this._aLogs.push({time:(Math.round(c*1000)/1000),type:d,source:a,message:b});return this.showlog()};this.showlog=function(){if(!this._oDivLog){return false}var b="";for(var a=(this._aLogs.length-1);a>=0;a--){b+='<div class="'+this._aLogs[a]["type"]+'"><span class="time">'+this._aLogs[a]["time"]+'</span><span class="source">'+this._aLogs[a]["source"]+'</span> <span class="message">'+this._aLogs[a]["message"]+"</span></div>"}return this._oDivLog.innerHTML=b};this.init=function(){this._getName();console.log(this.name);this._aLogs=[];this.starttime=this._microtime(true);this.log("info","debugger","START");this.log("info","debugger","UA: "+navigator.userAgent);return true}};mdbg.prototype.global=this;